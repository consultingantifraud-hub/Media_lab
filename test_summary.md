# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è Flux 2 Flex

## ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

1. **test_flux2flex_prompt_direct.py** - ‚úÖ –£–°–ü–ï–•
   - –õ–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç Flux 2 Flex
   - –ü—Ä–æ–º–ø—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
   - –ü–µ—Ä–µ–≤–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

2. **test_worker_prompt_actual.py** - ‚úÖ –£–°–ü–ï–•
   - –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤–æ—Ä–∫–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - –ü—Ä–æ–º–ø—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
   - –ë–ª–æ–∫ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

3. **test_worker_direct_call.py** (–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ) - ‚úÖ –£–°–ü–ï–•
   - –§—É–Ω–∫—Ü–∏—è process_image_job –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
   - –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - provider_prompt —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è = –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç
   - –ë–ª–æ–∫ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
   - –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

1. **app/providers/fal/image_worker_server.py** (—Å—Ç—Ä–æ–∫–∏ 929-1006)
   - ‚úÖ –ö–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –º–æ–¥–µ–ª–∏ –î–û –∏–∑–≤–ª–µ—á–µ–Ω–∏—è provider_prompt
   - ‚úÖ –î–ª—è Flux 2 Flex —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `provider_prompt = prompt` (—Ä—É—Å—Å–∫–∏–π)
   - ‚úÖ –ë–ª–æ–∫ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è Flux 2 Flex (`if not (is_nano_banana or is_flux2flex or is_gpt_create)`)
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏ —Å —ç–º–æ–¥–∑–∏ (üö®üö®üö® FLUX2FLEX DEBUG)

2. **app/bot/handlers/image.py** (—Å—Ç—Ä–æ–∫–∏ 461-463)
   - ‚úÖ –î–ª—è Flux 2 Flex –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `provider_prompt` –≤ –±–æ—Ç–µ
   - ‚úÖ –í–æ—Ä–∫–µ—Ä –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä—É—Å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ –≤ `image_worker_server.py`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏
3. ‚úÖ –û—á–∏—â–µ–Ω –∫–µ—à Python (.pyc —Ñ–∞–π–ª—ã –∏ __pycache__)
4. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã –≤—Å–µ –≤–æ—Ä–∫–µ—Ä—ã
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω –∫–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ - –æ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ª–æ–≥–∞—Ö –≤–æ—Ä–∫–µ—Ä–∞:
- –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π —Å —ç–º–æ–¥–∑–∏ (üö®üö®üö® FLUX2FLEX DEBUG)
- –ü—Ä–æ–º–ø—Ç –≤—Å–µ –µ—â–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω—ã —Å—Ç–∞—Ä—ã–µ –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ (1083, 1119, 1121)

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

1. –í–æ—Ä–∫–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞ –∏–∑ –æ–±—Ä–∞–∑–∞ Docker (–Ω–µ –∏–∑ volume)
2. Python –∫–µ—à–∏—Ä—É–µ—Ç –º–æ–¥—É–ª–∏ –≤ –ø–∞–º—è—Ç–∏ –∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Ö
3. –ö–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –Ω–æ –≥–¥–µ-—Ç–æ –µ—â–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–≤–æ–¥

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É —Å Flux 2 Flex –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —ç–º–æ–¥–∑–∏
2. –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç - –≤–æ—Ä–∫–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–¥
3. –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –µ—Å—Ç—å, –Ω–æ –ø—Ä–æ–º–ø—Ç –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ




