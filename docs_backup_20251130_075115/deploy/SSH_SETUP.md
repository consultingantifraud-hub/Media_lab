# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VPS —Å–µ—Ä–≤–µ—Ä—É

## üìã –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–∞ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)

#### Windows (PowerShell):
```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞
ls ~/.ssh/id_rsa.pub

# –ï—Å–ª–∏ –∫–ª—é—á–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
Get-Content ~/.ssh/id_rsa.pub | Set-Clipboard
```

#### Linux/WSL:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞
ls ~/.ssh/id_rsa.pub

# –ï—Å–ª–∏ –∫–ª—é—á–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

# –ü–æ–∫–∞–∑–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
cat ~/.ssh/id_rsa.pub
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ SSH –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id username@your-server-ip

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
cat ~/.ssh/id_rsa.pub | ssh username@your-server-ip "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### Windows:
1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (–µ—Å–ª–∏ –Ω–µ—Ç): `mkdir C:\Users\<username>\.ssh`
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `ssh_config.example` –≤ `C:\Users\<username>\.ssh\config`
3. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª, –∑–∞–º–µ–Ω–∏–≤:
   - `YOUR_SERVER_IP_OR_DOMAIN` –Ω–∞ IP –∏–ª–∏ –¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - `YOUR_USERNAME` –Ω–∞ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—É—Ç—å –∫ –∫–ª—é—á—É

#### Linux/WSL:
```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (–µ—Å–ª–∏ –Ω–µ—Ç)
mkdir -p ~/.ssh
chmod 700 ~/.ssh

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp ssh_config.example ~/.ssh/config

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nano ~/.ssh/config

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
chmod 600 ~/.ssh/config
```

### 4. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `~/.ssh/config` (–∏–ª–∏ `C:\Users\<username>\.ssh\config` –Ω–∞ Windows) –∏ –∑–∞–º–µ–Ω–∏—Ç–µ:

```
Host media-lab-vps
    HostName YOUR_SERVER_IP_OR_DOMAIN      # –ù–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100 –∏–ª–∏ server.example.com
    User YOUR_USERNAME                      # –ù–∞–ø—Ä–∏–º–µ—Ä: root –∏–ª–∏ deploy
    Port 22                                 # –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22)
    IdentityFile ~/.ssh/id_rsa             # –ü—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ –ø–æ –∏–º–µ–Ω–∏:

```bash
ssh media-lab-vps
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

#### Windows (PowerShell):
```powershell
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
.\scripts\ssh-connect.ps1

# –ò–ª–∏ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
.\scripts\ssh-connect.ps1 -ServerName media-lab-vps

# –ò–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
.\scripts\ssh-connect.ps1 -ServerIP "192.168.1.100" -Username "deploy" -Port 22
```

#### Linux/WSL:
```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x scripts/ssh-connect.sh

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
./scripts/ssh-connect.sh

# –ò–ª–∏ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
./scripts/ssh-connect.sh media-lab-vps
```

### –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ë–∞–∑–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh username@server-ip

# –° —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ—Ä—Ç–∞
ssh -p 2222 username@server-ip

# –° —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–ª—é—á–∞
ssh -i ~/.ssh/id_rsa username@server-ip
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –∫–ª—é—á–∏ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π**
   ```bash
   # –û—Ç–∫–ª—é—á–∏—Ç—å –≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª—é—á–µ–π)
   sudo nano /etc/ssh/sshd_config
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: PasswordAuthentication no
   sudo systemctl restart sshd
   ```

2. **–ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç SSH** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å /etc/ssh/sshd_config
   Port 2222
   ```

3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –ø–æ IP** (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
   ```bash
   # –í /etc/ssh/sshd_config
   AllowUsers username@your-ip
   ```

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ fail2ban** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
   ```bash
   sudo apt install fail2ban
   sudo systemctl enable fail2ban
   sudo systemctl start fail2ban
   ```

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã SSH

### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp file.txt username@server:/path/to/destination/

# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª —Å —Å–µ—Ä–≤–µ—Ä–∞
scp username@server:/path/to/file.txt ./

# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
scp -r directory/ username@server:/path/to/destination/
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É
ssh username@server "ls -la"

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥
ssh username@server "cd /opt/media-lab && docker ps"
```

### –¢—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤

```bash
# –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å (–¥–æ—Å—Ç—É–ø –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –ø–æ—Ä—Ç—É –ª–æ–∫–∞–ª—å–Ω–æ)
ssh -L 8000:localhost:8000 username@server

# –£–¥–∞–ª–µ–Ω–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å (–¥–æ—Å—Ç—É–ø –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –ø–æ—Ä—Ç—É —É–¥–∞–ª–µ–Ω–Ω–æ)
ssh -R 8000:localhost:8000 username@server
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Permission denied (publickey)"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –∫–ª—é—á–∏:
   ```bash
   chmod 600 ~/.ssh/id_rsa
   chmod 644 ~/.ssh/id_rsa.pub
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   ssh username@server "cat ~/.ssh/authorized_keys"
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   sudo nano /etc/ssh/sshd_config
   # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
   # PubkeyAuthentication yes
   # AuthorizedKeysFile .ssh/authorized_keys
   ```

### –û—à–∏–±–∫–∞ "Host key verification failed"

```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–ª—é—á —Ö–æ—Å—Ç–∞
ssh-keygen -R server-ip

# –ò–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ~/.ssh/known_hosts –≤—Ä—É—á–Ω—É—é
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ–µ

–î–æ–±–∞–≤—å—Ç–µ –≤ `~/.ssh/config`:
```
Host *
    GSSAPIAuthentication no
    UseDNS no
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OpenSSH –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://www.openssh.com/manual.html)
- [SSH –∫–ª—é—á–∏ - GitHub Guide](https://docs.github.com/en/authentication/connecting-to-github-with-ssh)

