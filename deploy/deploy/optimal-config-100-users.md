# –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- **CPU:** 3 —è–¥—Ä–∞
- **RAM:** 3 GB
- **–î–∏—Å–∫:** 60 GB
- **OS:** Ubuntu 24.04 LTS

## üíæ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (3 GB)

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
- **–°–∏—Å—Ç–µ–º–∞:** ~400-500 MB
- **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:** ~600-700 MB
- **–ù–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** ~15-18 MB
- **–î–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** ~1500-1800 MB
- **–ò–¢–û–ì–û:** ~2500-3000 MB (83-100% –æ—Ç RAM)

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ü–∞–º—è—Ç—å –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é!

## üîß –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Docker

### 1. Redis
```yaml
deploy:
  resources:
    limits:
      memory: 256M
    reservations:
      memory: 64M
command: redis-server --appendonly yes --maxmemory 512mb --maxmemory-policy allkeys-lru
```
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –£–≤–µ–ª–∏—á–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –æ—á–µ—Ä–µ–¥–µ–π.

### 2. API
```yaml
command: uvicorn app.web.api:app --host 0.0.0.0 --port 8000 --workers 2 --limit-concurrency 150
deploy:
  resources:
    limits:
      memory: 200M
    reservations:
      memory: 120M
```
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** 2 workers –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, —É–≤–µ–ª–∏—á–µ–Ω limit-concurrency –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### 3. Bot
```yaml
deploy:
  resources:
    limits:
      memory: 150M
    reservations:
      memory: 100M
```
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### 4. Worker (–û–°–ù–û–í–ù–û–ô)
```yaml
command: rq worker -u redis://127.0.0.1:6379/0 img_queue --name worker-image-1 --max-jobs 15
deploy:
  resources:
    limits:
      memory: 250M
    reservations:
      memory: 100M
```
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –£–≤–µ–ª–∏—á–µ–Ω max-jobs –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–¥–∞—á –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —É–≤–µ–ª–∏—á–µ–Ω memory limit –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

### 5. Worker (–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø
```yaml
worker-image-2:
  # –ö–æ–ø–∏—è worker-image-1 —Å –¥—Ä—É–≥–∏–º –∏–º–µ–Ω–µ–º
  command: rq worker -u redis://127.0.0.1:6379/0 img_queue --name worker-image-2 --max-jobs 15
  deploy:
    resources:
      limits:
        memory: 250M
      reservations:
        memory: 100M
```
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –í—Ç–æ—Ä–æ–π worker –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏. –£–¥–≤–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

## üìà –ò—Ç–æ–≥–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–¥–∏–Ω worker (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π)
- Redis: 256 MB
- API: 200 MB
- Bot: 150 MB
- Worker: 250 MB
- **–í—Å–µ–≥–æ Docker:** ~856 MB
- **–°–∏—Å—Ç–µ–º–∞:** ~400 MB
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (100):** ~1500-1800 MB
- **–ò–¢–û–ì–û:** ~2756-3056 MB (92-102% –æ—Ç RAM) ‚ö†Ô∏è

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–≤–∞ worker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
- Redis: 256 MB
- API: 200 MB
- Bot: 150 MB
- Worker 1: 250 MB
- Worker 2: 250 MB
- **–í—Å–µ–≥–æ Docker:** ~1106 MB
- **–°–∏—Å—Ç–µ–º–∞:** ~400 MB
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (100):** ~1500-1800 MB
- **–ò–¢–û–ì–û:** ~3006-3306 MB (100-110% –æ—Ç RAM) ‚ö†Ô∏è‚ö†Ô∏è

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –ü–∞–º—è—Ç—å
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –ø–∞–º—è—Ç—å –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ 100%+
- **–†–µ—à–µ–Ω–∏–µ:** 
  - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å swap (–º–∏–Ω–∏–º—É–º 2 GB)
  - –ò–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å RAM –¥–æ 4-6 GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 2. CPU
- **–ü—Ä–æ–±–ª–µ–º–∞:** 3 —è–¥—Ä–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ
- **–†–µ—à–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CPU, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 4-6 —è–¥–µ—Ä

### 3. –í–Ω–µ—à–Ω–∏–µ API (Fal.ai)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω, –≤–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–µ–Ω upgrade

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ):
- –û–¥–∏–Ω worker —Å max-jobs=15
- Memory limits –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å swap (2-4 GB)
- –ê–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- **–£–≤–µ–ª–∏—á–∏—Ç—å RAM –¥–æ 4-6 GB** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1)
- –î–≤–∞ worker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- Memory limits –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å swap –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤

### –ò–¥–µ–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- **RAM: 6-8 GB**
- **CPU: 4-6 —è–¥–µ—Ä**
- –î–≤–∞ worker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ memory limits
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ LLM –∑–∞–ø—Ä–æ—Å–æ–≤

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏:
- **–ü–∞–º—è—Ç—å:** –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å <95% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **CPU:** –°—Ä–µ–¥–Ω—è—è –∑–∞–≥—Ä—É–∑–∫–∞ <80%
- **Swap:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ <50%
- **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á:** –î–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ <100 –∑–∞–¥–∞—á
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API:** <2 —Å–µ–∫—É–Ω–¥—ã

### –ê–ª–µ—Ä—Ç—ã:
- –ü–∞–º—è—Ç—å >95% - –∫—Ä–∏—Ç–∏—á–Ω–æ
- Swap –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è >50% - —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–≤–µ–ª–∏—á–µ–Ω–∏–µ RAM
- –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á >100 - —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ workers
- CPU >90% - —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ CPU

## üîÑ –ü–ª–∞–Ω –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 1: –¢–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä (3 GB RAM)
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å swap (2-4 GB)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### –≠—Ç–∞–ø 2: –ü—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏
- –£–≤–µ–ª–∏—á–∏—Ç—å RAM –¥–æ 4-6 GB
- –î–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π worker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 3: –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
- –£–≤–µ–ª–∏—á–∏—Ç—å RAM –¥–æ 6-8 GB
- –£–≤–µ–ª–∏—á–∏—Ç—å CPU –¥–æ 4-6 —è–¥–µ—Ä
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ




